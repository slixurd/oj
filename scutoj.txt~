CREATE DATABASE scutoj;

USE scutoj;

CREATE TABLE user(
userId INT(11) NOT NULL AUTO_INCREMENT,
name VARCHAR(20) NOT NULL UNIQUE,
email VARCHAR(100) NOT NULL UNIQUE,
password VARCHAR(50) NOT NULL,
salt VARCHAR(40) NOT NULL,
type VARCHAR(10),
programLan VARCHAR(10),
language VARCHAR(20),
regTime DATETIME,
nick VARCHAR(50),
school VARCHAR(50),
defunct TINYINT(0) NOT NULL DEFAULT 0 ,
PRIMARY KEY(userId),
KEY(name),
KEY(email)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 AUTO_INCREMENT = 10000;

CREATE TABLE user_state(
userId INT(11) NOT NULL,
accessTime DATETIME ,
submit INT(11) DEFAULT 0,
solved INT(11) DEFAULT 0,
PRIMARY KEY(userId)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE login_log(
userId INT(11) NOT NULL,
password VARCHAR(32) NOT NULL,
ip VARCHAR(20),
time DATETIME
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE news(
newsId INT(11) NOT NULL,
userId INT(11) NOT NULL,
title VARCHAR(200) NOT NULL,
cotent TEXT NOT NULL,
startTime DATETIME NOT NULL,
endTime DATETIME NOT NULL,
source VARCHAR(50),
defunct TINYINT(0) NOT NULL DEFAULT 0,
PRIMARY KEY(newsId)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 AUTO_INCREMENT = 10000;

CREATE TABLE problem(
problemId INT(11) NOT NULL AUTO_INCREMENT,
title VARCHAR(200) NOT NULL,
description TEXT ,
input TEXT,
output TEXT,
sampleInput TEXT,
sampleOutput TEXT,
hint TEXT,
source VARCHAR(200),
inDate DATETIME ,
timeLimit INT(11) NOT NULL,
memoryLimit INT(11) NOT NULL,
defunct TINYINT(0) NOT NULL DEFAULT 0,
accepted INT(11) NOT NULL DEFAULT 0,
submit INT(11) NOT NULL DEFAULT 0,
PRIMARY KEY(problemId)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 AUTO_INCREMENT = 10000;

CREATE TABLE problem_privilege(
problemId INT(11) NOT NULL,
userId INT(11) NOT NULL,
priType VARCHAR(10) NOT NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE solution(
solutionId INT(11) NOT NULL AUTO_INCREMENT,
problemId INT(11) NOT NULL,
userId INT(11) NOT NULL,
runTime INT(11) NOT NULL,
memory INT(11) NOT NULL,
inDate DATETIME ,
result SMALLINT(6) NOT NULL,
programLan VARCHAR(20) NOT NULL,
contestId INT(11),
unitId INT(11),
valid TINYINT(0),
judgeTime DATETIME ,
PRIMARY KEY(solutionId)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 AUTO_INCREMENT = 10000;

CREATE TABLE solution_code(
solutionId INT(11) NOT NULL,
code TEXT,
PRIMARY KEY(solutionId)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE compile_info(
problemId INT(11) NOT NULL,
error TEXT,
PRIMARY KEY(problemId)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;


CREATE TABLE runtime_info(
problemId INT(11) NOT NULL,
error TEXT,
PRIMARY KEY(problemId)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE sim(
solutionId INT(11) NOT NULL,
simSolutionId INT(11) NOT NULL,
sim TINYINT(3) NOT NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE contest(
contestId INT(11) NOT NULL AUTO_INCREMENT,
title VARCHAR(200) DEFAULT '',
startTime DATETIME ,
endTime DATETIME,
defunct TINYINT(0) NOT NULL DEFAULT 0,
description TEXT,
private TINYINT(0) NOT NULL DEFAULT 0,
language VARCHAR(20) NOT NULL ,
PRIMARY KEY(contestId)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 AUTO_INCREMENT = 10000;

CREATE TABLE contest_problem(
problemId INT(11) NOT NULL,
contestId INT(11) NOT NULL,
title VARCHAR(200) NOT NULL,
num INT(11) NOT NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE contest_privilege(
contestId INT(11) NOT NULL,
userId INT(11) NOT NULL,
priType VARCHAR(10) NOT NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE course(
courseId INT(11) NOT NULL AUTO_INCREMENT,
userId INT(11) NOT NULL,
name VARCHAR(40) NOT NULL,
begainTime DATETIME NOT NULL,
endTime DATETIME NOT NULL,
defunct TINYINT(3) NOT NULL DEFAULT 0,
private TINYINT(3) NOT NULL,
language VARCHAR(30),
PRIMARY KEY(courseId)
)ENGINE=InnoDB DEFAULT CHARSET=utf8 AUTO_INCREMENT = 10000;

CREATE TABLE course_unit(
unitId INT(11) NOT NULL,
courseId INT(11) NOT NULL,
title VARCHAR(200) NOT NULL,
PRIMARY KEY(unitId)
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE unit_problem(
unitId INT(11) NOT NULL,
problemId INT(11) NOT NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE course_privilege(
courseId INT(11) NOT NULL,
userId INT(11) NOT NULL,
type VARCHAR(10) NOT NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE IF NOT EXISTS  `ci_sessions` (
  session_id varchar(40) DEFAULT '0' NOT NULL,
  ip_address varchar(45) DEFAULT '0' NOT NULL,
  user_agent varchar(120) NOT NULL,
  last_activity int(10) unsigned DEFAULT 0 NOT NULL,
  user_data text DEFAULT '' NOT NULL,
  PRIMARY KEY (session_id),
  KEY `last_activity_idx` (`last_activity`)
);


