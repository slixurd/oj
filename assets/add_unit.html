<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>为课程添加实验\作业</title>
<meta http-equiv="Content-Type" content="text/html" charset="utf-8"/>
<link rel="stylesheet" type="text/css" href="css/admin.css">
<script type="text/javascript" src="js/jquery-1.9.1.js"></script>
<script type="text/javascript" src="js/admin.js"></script>
</head>
<body>
<div class="wrapper">
<div class="container clearfix">
	<ul class="slide-bar pull-left">
		<li><a href="#">题目列表</a></li>
		<li><a href="#">添加题目</a></li>
		<li class="active"><a href="#">课程列表</a></li>
		<li><a href="#">添加课程</a></li>
		<li><a href="#">竞赛列表</a></li>
		<li><a href="#">添加竞赛</a></li>
		<li><a href="#">排名</a></li>
		<li><a href="#">状态</a></li>
		<li><a href="#">账号生成器</a></li>
		<li><a href="#">权限管理</a></li>
		<li><a href="#">修改密码</a></li>
		<li><a href="#">新手须知</a></li>
	</ul>

	<div class="add-tab pull-right">
		<table class="table">
			<caption>单元列表</caption>
			<thead>
				<tr>
					<th class="span1">单元ID</th>
					<th class="span7">名称</th>
					<th class="span6">开始时间</th>
					<th class="span6">结束时间</th>
					<th class="span2">编辑</th>
					<th class="span2">删除</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td>1001</td>
					<td title="数据结构数据结构数据结构">数据结构数据结构数据结构</td>
					<td>2014-07-21 14:00</td>
					<td>2014-07-21 14:00</td>
					<td><a href="#">编辑</a></td>
					<td><a href="#">删除</a></td>
				</tr>
				<tr>
					<td>1001</td>
					<td title="数据结构数据结构数据结构">数据结构数据结构数据结构</td>
					<td>2014-07-21 14:00</td>
					<td>2014-07-21 14:00</td>
					<td><a href="#">编辑</a></td>
					<td><a href="#">删除</a></td>
				</tr>
				<tr>
					<td>1001</td>
					<td title="数据结构数据结构数据结构">数据结构数据结构数据结构</td>
					<td>2014-07-21 14:00</td>
					<td>2014-07-21 14:00</td>
					<td><a href="#">编辑</a></td>
					<td><a href="#">删除</a></td>
				</tr>
				<tr>
					<td>1001</td>
					<td title="数据结构数据结构数据结构">数据结构数据结构数据结构</td>
					<td>2014-07-21 14:00</td>
					<td>2014-07-21 14:00</td>
					<td><a href="#">编辑</a></td>
					<td><a href="#">删除</a></td>
				</tr>
			</tbody>
		</table>

		<div>
		<form action="#" method="post">
			<h3>新建单元</h3>
			<div class="row">
				<span class="tip">名称：</span>
				<input autocomplete="off" class="necessary" id="title" type="text" name="title" />
			</div>
			<div class="row">
				<span class="tip">开始时间：</span>
				<div class="select-down">
					<span class="year placeholder">年<i class="down"></i></span>
					<select class="year" autocomplete="off" id="syear" name="start_year">
					</select>
				</div>
				<div class="select-down">
					<span class="month placeholder">月<i class="down"></i></span>
					<select class="month" autocomplete="off" id="smonth" name="start_mon">
					</select>
				</div>
				<div class="select-down">
					<span class="date placeholder">日<i class="down"></i></span>
					<select class="date" autocomplete="off" id="sdate" name="start_date">
					</select>
				</div>
				<div class="select-down">
					<span class="hour placeholder">时<i class="down"></i></span>
					<select class="hour" autocomplete="off" id="shour" name="start_hour">
					</select>
				</div>
				<div class="select-down last-child">
					<span class="minute placeholder">分<i class="down"></i></span>
					<select class="minute" autocomplete="off" id="sminute" name="start_min">
					</select>
				</div>
			</div>
			<div class="row">
				<span class="tip">结束时间：</span>
				<div class="select-down">
					<span class="year placeholder">年<i class="down"></i></span>
					<select class="year" autocomplete="off" id="eyear" name="end_year">
					</select>
				</div>
				<div class="select-down">
					<span class="month placeholder">月<i class="down"></i></span>
					<select class="month" autocomplete="off" id="emonth" name="end_mon">
					</select>
				</div>
				<div class="select-down">
					<span class="date placeholder">日<i class="down"></i></span>
					<select class="date" autocomplete="off" id="edate" name="end_date">
					</select>
				</div>
				<div class="select-down">
					<span class="hour placeholder">时<i class="down"></i></span>
					<select class="hour" autocomplete="off" id="ehour" name="end_hour">
					</select>
				</div>
				<div class="select-down last-child"> 
					<span class="minute placeholder">分<i class="down"></i></span>
					<select class="minute" autocomplete="off" id="eminute" name="end_min">
					</select>
				</div>
			</div>
			<div class="row">
				<span class="tip">编程语言：</span>
				<div class="select-down" id="language">
					<span class="placeholder">C++<i class="down"></i></span>
					<select autocomplete="off" class="select-down-select">
						<option value="0">C</option>
						<option value="1">C++</option>
						<option value="2">Pascal</option>
						<option value="3">Java</option>
						<option value="4">Ruby</option>
						<option value="5">Bash</option>
						<option value="6">Python</option>
						<option value="7">PHP</option>
						<option value="8">Perl</option>
						<option value="9">C#</option>
						<option value="10">Obj-C</option>
						<option value="11">Free Basic</option>
					</select>
				</div>
			</div>
			<div class="submit-footer">
				<input type="submit" class="btn" value="确认添加" />
			</div>
		</form>
		</div>
	</div>
</div>
</div>

<script type="text/javascript">
	loadTimeWidget();
	$('form').bind('submit', function(event) {
		if(!check_ness()) {
			return false;
		}
		var syear,smonth,sdate,shour,sminute,stime;
		var eyear,emonth,edate,ehour,eminute,etime;
		var url = $('form').attr('action');
		syear = $('#syear').val();
		smonth = parseInt($('#smonth').val()) < 10 ? '0' + $('#smonth').val() : $('#smonth').val();
		sdate = parseInt($('#sdate').val()) < 10 ? '0' + $('#sdate').val() : $('#sdate').val();
		if($('#shour')[0])
			shour = parseInt($('#shour').val()) < 10 ? '0' + $('#shour').val() : $('#shour').val();
		else 
			shour = '00';
		if($('#sminute')[0])
			sminute = parseInt($('#sminute').val()) < 10 ? '0' + $('#sminute').val() : $('#sminute').val();
		 else 
		 	sminute = '00';

		eyear = $('#eyear').val();
		emonth = parseInt($('#emonth').val()) < 10 ? '0' + $('#emonth').val() : $('#emonth').val();
		edate = parseInt($('#edate').val()) < 10 ? '0' + $('#edate').val() : $('#edate').val();
		if($('#ehour')[0])
			ehour = parseInt($('#ehour').val()) < 10 ? '0' + $('#ehour').val() : $('#ehour').val();
		else
			ehour = '00';
		if($('#eminute')[0])
			eminute = parseInt($('#eminute').val()) < 10 ? '0' + $('#eminute').val() : $('#eminute').val();
		else
			eminute = '00';
		stime = syear + '-' + smonth + '-' + sdate + ' ' + shour + ':' + sminute + ':00';
		etime = eyear + '-' + emonth + '-' + edate + ' ' + ehour + ':' + eminute + ':00';
			
		//开始时间必须小于结束时间
		var s = new Date(),e = new Date();
		s.setFullYear(parseInt(syear));
		s.setMonth(parseInt(smonth));
		s.setDate(parseInt(sdate));
		s.setHours(parseInt(shour));
		s.setMinutes(parseInt(sminute));
		s.setSeconds(parseInt(0));

		e.setFullYear(parseInt(eyear));
		e.setMonth(parseInt(emonth));
		e.setDate(parseInt(edate));
		e.setHours(parseInt(ehour));
		e.setMinutes(parseInt(eminute));
		e.setSeconds(parseInt(0));
		if(s < e) {
			$.ajax({
				url: url,
				type: 'POST',
				dataType: 'text',
				data: {
					stime: stime,
					etime: etime
				},
			})
			.done(function() {
					
			})
			.fail(function() {
				console.log("fail");
			})
			.always(function() {
				console.log("complete");
			});
				
		} else {
			if($('#syear').parents('.row')[0] == $('#eyear').parents('.row')[0]){
				$('#syear').parents('.row').next('.popTip').remove();
				popTip($('#syear').parents('.row')[0],'开始时间必须小于结束时间','top','permanent');
			} else {
				$('#syear').parents('.row').next('.popTip').remove();
				$('#eyear').parents('.row').next('.popTip').remove();
				popTip($('#syear').parents('.row')[0],'开始时间必须小于结束时间','top','permanent');
				popTip($('#eyear').parents('.row')[0],'结束时间必须大于开始时间','top','permanent')
			}
			return false;
		}
	});
</script>
</body>
</html>