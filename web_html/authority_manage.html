<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>权限管理</title>
<meta http-equiv="Content-Type" content="text/html" charset="utf-8"/>
<link rel="stylesheet" type="text/css" href="css/admin.css">
<script type="text/javascript" src="js/jquery-1.9.1.js"></script>
<script type="text/javascript" src="js/admin.js"></script>
</head>
<body>
<div class="wrapper">
	<div class="container clearfix">
		<ul class="slide-bar pull-left">
		<li><a href="#">题目列表</a></li>
		<li><a href="#">添加题目</a></li>
		<li><a href="#">课程列表</a></li>
		<li><a href="#">添加课程</a></li>
		<li><a href="#">竞赛列表</a></li>
		<li><a href="#">添加竞赛</a></li>
		<li><a href="#">排名</a></li>
		<li><a href="#">状态</a></li>
		<li><a href="#">账号生成器</a></li>
		<li class="active"><a href="#">权限管理</a></li>
		<li><a href="#">修改密码</a></li>
		<li><a href="#">新手须知</a></li>
		</ul>

		<div class="authority pull-right">
			<table class="table">
				<caption>用户列表</caption>
				<thead>
					<tr>
						<th class="span3">用户</th>
						<th class="span4">权限</th>
						<th class="span4">备注</th>
						<th class="span2">删除</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td title="AdminAdminAdminAdminAdmin">AdminAdminAdminAdminAdmin</td>
						<td>administrator</td>
						<td title="拥有最高管理权限">拥有最高管理权限</td>
						<td><a class="pdel" href="#">删除</a></td>
					</tr>
					<tr>
						<td title="AdminAdminAdminAdminAdmin">AdminAdminAdminAdminAdmin</td>
						<td>administrator</td>
						<td title="拥有最高管理权限">拥有最高管理权限</td>
						<td><a class="pdel" href="#">删除</a></td>
					</tr>
					<tr>
						<td title="AdminAdminAdminAdminAdmin">AdminAdminAdminAdminAdmin</td>
						<td>administrator</td>
						<td title="拥有最高管理权限">拥有最高管理权限</td>
						<td><a class="pdel" href="#">删除</a></td>
					</tr>
				</tbody>
			</table>

			<div class="margin-top">
			<h3>权限设置</h3>
			<div class="row">
				<span class="tip">用户ID：</span>
				<input type="text" id="userid1" />
			</div>
			<div class="row">
				<span class="tip">权限类型：</span>
				<div class="select-down">
					<span class="select-down-span">admin<i class="down"></i></span>
					<select id="type1" class="select-down-select">
						<option value="0">admin</option>
						<option value="1">teacher</option>
						<option value="2">assistant</option>
						<option value="-1">DEL</option>
					</select>
				</div>
			</div>
			<div class="submit-footer" style="padding-top:0">
				<input id="submit1" type="button" class="btn" value="确认修改" />
			</div>
			<hr />
			<div class="row">
				<span class="tip">用户ID：</span>
				<input type="text" id="userid2" />
			</div>
			<div class="row">
				<span class="tip">类型选择：</span>
				<div class="select-down">
					<span class="select-down-span">course<i class="down"></i></span>
					<select id="type2" class="select-down-select">
						<option value="0">course</option>
						<option value="1">contest</option>
					</select>
				</div>
			</div>
			<div class="row">
					<span class="tip">权限：</span>
				<div style="display:inline-block;width:195px;vertical-align:middle;text-align:left">
					<input id="read" style="margin:0 5px 0 10px" type="checkbox" />r
					<input id="write" style="margin:0 5px 0 40px" type="checkbox" />w
					<input id="exec" style="margin:0 5px 0 40px" type="checkbox" />x
				</div>
			</div>
			<div class="submit-footer" style="padding-top:0">
				<input id="submit2" type="button" class="btn" value="确认修改" />
			</div>
			</div>
		</div>
	</div>
</div>
<script type="text/javascript">
	doSelect();

	$('.pdel').bind('click', function(event) {
		$(this).parents('tr').fadeOut();
	});

	$("#submit1").bind('click', function(event) {
		var url,userid,type;
		url = 'http://www.baidu.com';
		userid = $('#userid1').val();
		type = $('#type1').val();

		$.ajax({
			url: url,
			type: 'POST',
			dataType: 'json',
			data: {
				userid: userid,
				type: type
			},
		})
		.done(function() {
			console.log("success");
		})
		.fail(function() {
			console.log("error");
		})
		.always(function() {
			console.log("complete");
		});
	});

/*
* rwx三个权限ajax传输的数据是长度为3的0和1组合字符串，后台将其转换为整数然后取模就好
*/
	$("#submit2").bind('click', function(event) {
		var url,userid,type,authority,read,write,exec;
		url = 'http://www.baidu.com';
		userid = $('#userid2').val();
		type = $('#type2').val();
		read = $('#read').prop('checked') ? 1 : 0;
		write = $('#write').prop('checked') ? 1 : 0;
		exec = $('#exec').prop('checked') ? 1 : 0;
		authority = "" + read + write + exec;

		$.ajax({
			url: url,
			type: 'POST',
			dataType: 'json',
			data: {
				userid: userid,
				type: type,
				authority: authority
		},
		})
		.done(function() {
			console.log("success");
		})
		.fail(function() {
			console.log("error");
		})
		.always(function() {
			console.log("complete");
		});
		
	});
</script>
</body>
</html>