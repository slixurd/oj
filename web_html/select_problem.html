<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>实验\作业列表</title>
<meta http-equiv="Content-Type" content="text/html" charset="utf-8"/>
<link rel="stylesheet" type="text/css" href="css/admin.css">
<script type="text/javascript" src="js/jquery-1.9.1.js"></script>
<script type="text/javascript" src="js/admin.js"></script>
</head>
<body>
<div class="wrapper">
	<div class="container clearfix">
		<ul class="slide-bar pull-left">
		<li><a href="#">题目列表</a></li>
		<li><a href="#">添加题目</a></li>
		<li class="active"><a href="#">课程列表</a></li>
		<li><a href="#">添加课程</a></li>
		<li><a href="#">竞赛列表</a></li>
		<li><a href="#">添加竞赛</a></li>
		<li><a href="#">排名</a></li>
		<li><a href="#">状态</a></li>
		<li><a href="#">账号生成器</a></li>
		<li><a href="#">权限管理</a></li>
		<li><a href="#">修改密码</a></li>
		<li><a href="#">新手须知</a></li>
		</ul>

		<div class="pull-right">
			<table class="table">
				<caption>××实验\作业</caption>
				<thead>
					<tr>
						<th class="span2">问题ID</th>
						<th class="span8">标题</th>
						<th class="span1">删除</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>1001</td>
						<td>大整数问题</td>
						<td><a class="pdel" href="#">删除</a></td>
					</tr>
					<tr>
						<td>1002</td>
						<td>回文问题</td>
						<td><a class="pdel" href="#">删除</a></td>
					</tr>
					<tr>
						<td>1003</td>
						<td>最短路径问题</td>
						<td><a class="pdel" href="#">删除</a></td>
					</tr>
				</tbody>
			</table>

			<div>
				<table class="table margin-top">
					<caption>选择已有题目</caption>
					<thead>
						<tr>
							<th class="span2">问题ID</th>
							<th class="span8">标题</th>
							<th class="span1">状态</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>1001</td>
							<td title="八皇后问题八皇后问题八皇后问题">八皇后问题八皇后问题八皇后问题</td>
							<td>
								<div class="checkbox">
									<input type="checkbox" name="select" autocomplete="off" />
								</div>
							</td>
						</tr>
						<tr>
							<td>1002</td>
							<td title="八皇后问题八皇后问题八皇后问题">八皇后问题八皇后问题八皇后问题</td>
							<td>
								<div class="checkbox">
									<input type="checkbox" name="select" autocomplete="off" />
								</div>
							</td>
						</tr>
						<tr>
							<td>1003</td>
							<td title="八皇后问题八皇后问题八皇后问题">八皇后问题八皇后问题八皇后问题</td>
							<td>
								<div class="checkbox">
									<input type="checkbox" name="select" autocomplete="off" />
								</div>
							</td>
						</tr>
						<tr>
							<td>1004</td>
							<td title="八皇后问题八皇后问题八皇后问题">八皇后问题八皇后问题八皇后问题</td>
							<td>
								<div class="checkbox">
									<input type="checkbox" name="select" autocomplete="off" />
								</div>
							</td>
						</tr>
						<tr>
							<td>1004</td>
							<td title="八皇后问题八皇后问题八皇后问题">八皇后问题八皇后问题八皇后问题</td>
							<td>
								<div class="checkbox">
									<input type="checkbox" name="select" autocomplete="off" />
								</div>
							</td>
						</tr>
						<tr>
							<td>1004</td>
							<td title="八皇后问题八皇后问题八皇后问题">八皇后问题八皇后问题八皇后问题</td>
							<td>
								<div class="checkbox">
									<input type="checkbox" name="select" autocomplete="off" />
								</div>
							</td>
						</tr>
						<tr>
							<td>1004</td>
							<td title="八皇后问题八皇后问题八皇后问题">八皇后问题八皇后问题八皇后问题</td>
							<td>
								<div class="checkbox">
									<input type="checkbox" name="select" autocomplete="off" />
								</div>
							</td>
						</tr>
						<tr>
							<td>1004</td>
							<td title="八皇后问题八皇后问题八皇后问题">八皇后问题八皇后问题八皇后问题</td>
							<td>
								<div class="checkbox">
									<input type="checkbox" name="select" autocomplete="off" />
								</div>
							</td>
						</tr>
						<tr>
							<td>1004</td>
							<td title="八皇后问题八皇后问题八皇后问题">八皇后问题八皇后问题八皇后问题</td>
							<td>
								<div class="checkbox">
									<input type="checkbox" name="select" autocomplete="off" />
								</div>
							</td>
						</tr>
						<tr>
							<td>1004</td>
							<td title="八皇后问题八皇后问题八皇后问题">八皇后问题八皇后问题八皇后问题</td>
							<td>
								<div class="checkbox">
									<input type="checkbox" name="select" autocomplete="off" />
								</div>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
<!--
			<div class="submit-footer">
				<a href="#" class="btn">返回</a>
				<input type="submit" class="btn" value="添加" />
				<input type="reset" class="btn" value="取消" />
			</div>
-->
		</div>
	</div>
</div>
<script type="text/javascript">
//使得网页初始加载时复选框的状态是正确的
	checkBox();
	loadStatus();

//复选框状态改变时动作
//******此处需要成功提交到后台并返回后才会执行相应的动作（此处鼠标貌似不能点击太快）
	$('body').on('change','[type="checkbox"]', function() {
		var pid = $(this).parents('tr').find('td:first').text();	//问题的ID
		var add;	//告诉后台提交的题目是“选择”还是“撤销选择”，“1”表示选择
		if($(this).prop('checked') == true || $(this).prop('checked') == "checked") {
			add = 1;
			$.getJSON('http://www.baidu.com', {pid: pid,add: add}, function(data) {
				if(data.status == true) {
					$(this).parent().addClass('checked');
					shrink($(this).parents('tr'),$('table').eq(0),true);
				} else {
					alert(data.reason);
				}
			});
		} else {
			add = 0;
			$.getJSON('http://www.baidu.com', {pid: pid,add: add}, function(data) {
				if(data.status == true) {
					$(this).parent().removeClass('checked');
					//var id = $(this).parents('tr').children(':first').text();
					var $trFrom = $('table')
								.eq(0)
								.find('tbody tr td:contains("' + pid + '")')
								.parent();
					shrink($trFrom,$(this).parents('tr'),false);
				} else {
					alert(data.reason)
				}
			});
		}
	});

    $("body").on("click",'.pdel', function(c){
        c.preventDefault();
        var line = $(this).parents('tr');
        var pid = line.find("td:first").text();
        var url = 'http://www.baidu.com'+'?'+pid;
            $.getJSON(url,function(data){
                if(data.status == true ){
                    line.fadeOut();
                }else{
                    alert(data.reason);
                }
            });
    })
</script>
</body>
</html>